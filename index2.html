<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/bootstrap.css" type="text/css"/>
    <link rel="stylesheet" href="css/styles2.css" type="text/css"/>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.13.2/TweenLite.min.js" type="text/javascript"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.13.2/plugins/CSSPlugin.min.js" type="text/javascript"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.13.2/easing/EasePack.min.js" type="text/javascript"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.13.2/TimelineLite.min.js" type="text/javascript"></script>
    <title></title>
</head>
<body>
<div id="carousel" class="hero" data-backgrounds="images/firehorse.jpg,images/waterfall.jpg,images/bla.jpg">
    <div class="chart-container">
        <div class="bg"></div>
        <div class="bars">
            <div id="bar1" class="bar" data-heights="25,70,120"></div>
            <div id="bar2" class="bar" data-heights="50,70,120"></div>
            <div id="bar3" class="bar" data-heights="75,70,120"></div>
            <div id="bar4" class="bar" data-heights="185,70,120"></div>
            <div id="bar5" class="bar" data-heights="80,70,120"></div>
            <div id="bar6" class="bar" data-heights="90,70,120"></div>
            <div id="bar7" class="bar" data-heights="60,70,120"></div>
            <div id="bar8" class="bar" data-heights="150,70,120"></div>
            <div id="bar9" class="bar" data-heights="175,70,120"></div>
            <div id="bar10" class="bar" data-heights="175,70,120"></div>
            <div id="bar11" class="bar" data-heights="290,70,120"></div>
            <div id="bar12" class="bar" data-heights="300,70,120"></div>
            <div id="bar13" class="bar" data-heights="280,70,120"></div>
            <div id="bar14" class="bar" data-heights="320,70,120"></div>
            <div id="bar15" class="bar" data-heights="340,70,120"></div>
            <div id="bar16" class="bar" data-heights="360,70,120"></div>
            <div id="bar17" class="bar" data-heights="250,70,120"></div>
            <div id="bar18" class="bar" data-heights="300,70,120"></div>
            <div id="bar19" class="bar" data-heights="380,70,120"></div>
            <div id="bar20" class="bar" data-heights="380,70,120"></div>
            <div id="bar21" class="bar" data-heights="355,70,120"></div>
            <div id="bar22" class="bar" data-heights="330,70,120"></div>
            <div id="bar23" class="bar" data-heights="370,70,120"></div>
            <div id="bar24" class="bar" data-heights="360,70,120"></div>
            <div id="bar25" class="bar" data-heights="350,70,120"></div>
            <div id="bar26" class="bar" data-heights="350,70,120"></div>
            <div id="bar27" class="bar" data-heights="340,70,120"></div>
            <div id="bar28" class="bar" data-heights="320,70,120"></div>
            <div id="bar29" class="bar" data-heights="280,70,120"></div>
            <div id="bar30" class="bar" data-heights="250,70,120"></div>
            <div id="bar31" class="bar" data-heights="235,70,120"></div>
            <div id="bar32" class="bar" data-heights="180,70,120"></div>
            <div id="bar33" class="bar" data-heights="160,70,120"></div>
            <div id="bar34" class="bar" data-heights="150,70,120"></div>
            <div id="bar35" class="bar" data-heights="140,70,120"></div>
            <div id="bar36" class="bar" data-heights="150,70,120"></div>
            <div id="bar37" class="bar" data-heights="50,70,120"></div>
            <div id="bar38" class="bar last" data-heights="20,70,120"></div>
        </div>
    </div>
</div>

<script>
    //        var tl = new TimelineLite();

    function BarChartCarousel(config){
        this.charts = config.charts || 3;
        this.container = config.container || jQuery('body');
        this.maxHeightAndOffset = -440;
        this.init();
    }

    BarChartCarousel.prototype = {
        init: function(){
            this.backgrounds = this.container.data('backgrounds').split(',');
            this.bars = this.container.find('.bars > div');
            this.setBarData();
            this.resetBars();
            this.setupTimeline();
        },

        setBarData: function(){
            var self = this;

            this.barData = [];
            this.bars.each(function(){
                var bar = jQuery(this);

                self.barData.push({
                    bar: bar,
                    heights: bar.data('heights').split(',')
                });
            });
        },

        resetBars: function(){
//            this.bars.height(1);

            var left = 0;
            this.bars.each(function(){
                var bar = jQuery(this);

                bar.css({
                    left: left,
                    bottom: '-' + (bar.height() - 1) + 'px'
                });
                left += 25;
            });
        },

        setupTimeline: function(){
            this.chartsTl = new TimelineLite();

            for(var i = 0; i < this.charts; i++){
                var chartTl = new TimelineLite();

                chartTl.add('myLabel', 0);

                for(var j = 0, len = this.barData.length; j < len; j++){
                    var barData = this.barData[j];

                    chartTl.add(TweenLite.to(barData.bar, 0.8, { bottom: this.maxHeightAndOffset + parseInt(barData.heights[i], 10), ease: Back.easeOut }), '-=0.7');
                }

                this.chartsTl.add(chartTl);
            }
        }
    };

    a = new BarChartCarousel({
        container: jQuery('#carousel'),
        charts: 1
    });
</script>
</body>
</html>